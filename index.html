<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë””ë©¤ë²„ ì•¡ì ì£¼ë¬¸</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Space+Mono:wght@400;700&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #f5f4f0;
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Noto Sans KR', sans-serif;
    padding: 24px;
  }

  .card {
    background: #fff;
    border-radius: 20px;
    padding: 40px;
    width: 100%;
    max-width: 500px;
    box-shadow: 0 4px 40px rgba(0,0,0,0.08);
  }

  h1 { font-size: 20px; font-weight: 700; color: #1a1a1a; margin-bottom: 4px; }
  .subtitle { font-size: 13px; color: #999; margin-bottom: 32px; }

  .section-label {
    font-size: 11px; font-weight: 700; letter-spacing: 0.08em;
    text-transform: uppercase; color: #aaa; margin-bottom: 12px;
  }

  /* â”€â”€ ìº”ë²„ìŠ¤ ì¹˜ìˆ˜ ì…ë ¥ â”€â”€ */
  .input-group {
    display: grid; grid-template-columns: 1fr 1fr 1fr;
    gap: 12px; margin-bottom: 28px;
  }
  .input-wrap { display: flex; flex-direction: column; gap: 6px; }
  .input-wrap label { font-size: 12px; font-weight: 500; color: #555; }
  .input-wrap input {
    border: 1.5px solid #e0e0e0; border-radius: 10px;
    padding: 10px 12px; font-size: 15px;
    font-family: 'Space Mono', monospace; font-weight: 700;
    color: #1a1a1a; background: #fafafa; text-align: center;
    outline: none; transition: border-color 0.2s, box-shadow 0.2s; width: 100%;
  }
  .input-wrap input:focus {
    border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79,70,229,0.1); background: #fff;
  }
  .unit { font-size: 11px; color: #bbb; text-align: center; }

  /* â”€â”€ ì œí’ˆ ì¹´ë“œ â”€â”€ */
  .sheet-status {
    font-size: 11px; color: #bbb; text-align: right;
    margin-bottom: 8px; min-height: 16px;
  }
  .sheet-status.ok { color: #10b981; }
  .sheet-status.err { color: #ef4444; }

  .product-card {
    background: #f8f7ff; border: 1.5px solid #e0deff;
    border-radius: 12px; padding: 14px 18px; margin-bottom: 20px;
    display: flex; justify-content: space-between; align-items: center; gap: 12px;
  }
  .product-card.not-found { background: #fff8f0; border-color: #ffe0cc; }
  .product-name { font-size: 14px; font-weight: 700; color: #3730a3; }
  .product-card.not-found .product-name { color: #c05c00; }
  .product-price {
    font-family: 'Space Mono', monospace;
    font-size: 18px; font-weight: 700; color: #4f46e5; white-space: nowrap;
  }
  .product-card.not-found .product-price { color: #c05c00; font-size: 13px; font-family: 'Noto Sans KR', sans-serif; }

  /* â”€â”€ ì•¡ì ë„ë©´ â”€â”€ */
  .result-box {
    background: #fff; border-radius: 14px;
    padding: 20px 24px 24px; text-align: center;
    border: 1.5px solid #e0e0e0; margin-bottom: 24px;
  }
  .result-label {
    font-size: 11px; font-weight: 700; letter-spacing: 0.1em;
    text-transform: uppercase; color: #aaa; margin-bottom: 12px;
  }
  .placeholder { color: #aaa; font-size: 13px; font-style: italic; padding: 32px 0; }
  #diagram-wrap { width: 100%; display: flex; justify-content: center; align-items: center; }
  #diagram-wrap svg { overflow: visible; }

  /* â”€â”€ ì£¼ë¬¸ ì •ë³´ â”€â”€ */
  .order-section {
    padding-top: 24px;
    border-top: 1px solid #ebebeb;
  }

  .order-fields {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 16px;
  }

  .order-row {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .order-row label {
    width: 60px;
    flex-shrink: 0;
    font-size: 12px;
    font-weight: 500;
    color: #555;
  }

  .order-row input {
    border: 1.5px solid #e0e0e0; border-radius: 10px;
    padding: 9px 12px; font-size: 14px;
    font-family: 'Noto Sans KR', sans-serif;
    color: #1a1a1a; background: #fafafa;
    outline: none; transition: border-color 0.2s, box-shadow 0.2s;
  }
  .order-row input.wide { width: 220px; }
  .order-row input.narrow { width: 90px; }
  .order-row input:focus {
    border-color: #4f46e5; box-shadow: 0 0 0 3px rgba(79,70,229,0.1); background: #fff;
  }

  .order-btn {
    width: 100%; padding: 14px;
    background: #4f46e5; color: #fff;
    font-size: 16px; font-weight: 700;
    font-family: 'Noto Sans KR', sans-serif;
    border: none; border-radius: 12px; cursor: pointer;
    transition: background 0.2s, transform 0.1s;
    letter-spacing: 0.02em;
  }
  .order-btn:hover { background: #4338ca; }
  .order-btn:active { transform: scale(0.98); }

  #order-msg {
    margin-top: 12px; font-size: 13px;
    text-align: center; min-height: 20px;
    color: #10b981; font-weight: 500;
  }
  #order-msg.err { color: #ef4444; }
</style>
</head>
<body>
<div class="card">

  <!-- 1. ì œëª© -->
  <h1>ë””ë©¤ë²„ ì•¡ì ì£¼ë¬¸</h1>
  <p class="subtitle">ìº”ë²„ìŠ¤ ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•˜ë©´ ì•¡ì ì‚¬ì´ì¦ˆë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

  <!-- 2. ìº”ë²„ìŠ¤ ì›ë³¸ ì¹˜ìˆ˜ -->
  <div class="section-label">ìº”ë²„ìŠ¤ ì›ë³¸ ì¹˜ìˆ˜ (mm)</div>
  <div class="input-group">
    <div class="input-wrap">
      <label>ê°€ë¡œ (W)</label>
      <input type="number" id="width" placeholder="0" min="0" oninput="calculate()" required required>
      <div class="unit">mm</div>
    </div>
    <div class="input-wrap">
      <label>ì„¸ë¡œ (H)</label>
      <input type="number" id="height" placeholder="0" min="0" oninput="calculate()" required required>
      <div class="unit">mm</div>
    </div>
    <div class="input-wrap">
      <label>ë‘ê»˜ (D)</label>
      <input type="number" id="depth" placeholder="0" min="0" oninput="calculate()" required required>
      <div class="unit">mm</div>
    </div>
  </div>

  <!-- 3. ì œí’ˆëª… & ê¸ˆì•¡ -->
  <div class="sheet-status" id="sheet-status"></div>
  <div id="product-area"></div>

  <!-- 4. ì•¡ì ì‚¬ì´ì¦ˆ ë„ë©´ -->
  <div class="result-box">
    <div class="result-label">ì•¡ì ì‚¬ì´ì¦ˆ</div>
    <div id="result">
      <div class="placeholder">ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•˜ë©´ ë„ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤</div>
    </div>
  </div>

  <!-- 5. ì£¼ë¬¸ ì •ë³´ -->
  <div class="order-section">
    <div class="section-label" style="margin-bottom:16px;">ì£¼ë¬¸ ì •ë³´</div>
    <div class="order-fields">
      <div class="order-row">
        <label>ì£¼ë¬¸ì</label>
        <input type="text" id="order-name" class="wide" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required required>
      </div>
      <div class="order-row">
        <label>ì „í™”ë²ˆí˜¸</label>
        <input type="tel" id="order-phone" class="wide" placeholder="010-0000-0000" required oninput="formatPhone(this)" required oninput="formatPhone(this)">
      </div>
      <div class="order-row">
        <label>ìˆ˜ëŸ‰</label>
        <input type="number" id="order-qty" class="narrow" placeholder="1" min="1" value="1" required required>
      </div>
    </div>
    <button class="order-btn" onclick="submitOrder()">ì£¼ë¬¸í•©ë‹ˆë‹¤</button>
    <div id="order-msg"></div>
  </div>

</div>
<script>
const SHEET_URL = 'https://script.google.com/macros/s/AKfycbyP9AaCURxtRCrCpxCguGKmv5l4fDMw1_osUoUN9MyfdNTW8jcMpwQ_9xAQTuPkfVt96A/exec';

let sheetData = [], sheetLoaded = false;

function formatPhone(input) {
  // ìˆ«ìì™€ - ì´ì™¸ ë¬¸ì ì¦‰ì‹œ ì œê±°
  input.value = input.value.replace(/[^0-9-]/g, '');
}

async function loadSheet() {
  const el = document.getElementById('sheet-status');
  el.textContent = 'ì‹œíŠ¸ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦';
  try {
    const res = await fetch(SHEET_URL);
    if (!res.ok) throw new Error();
    const json = await res.json();
    sheetData = json.map(row => {
      const obj = {};
      Object.keys(row).forEach(k => { obj[k.trim().toLowerCase()] = String(row[k]).trim(); });
      return obj;
    }).filter(r => r.width || r.name);
    sheetLoaded = true;
    el.textContent = `âœ“ ì‹œíŠ¸ ì—°ë™ë¨ (${sheetData.length}ê°œ ì œí’ˆ)`;
    el.className = 'sheet-status ok';
    calculate();
  } catch {
    el.textContent = 'âš  ì‹œíŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
    el.className = 'sheet-status err';
  }
}

function findProduct(w, h) {
  const TOLERANCE = 5;

  // 1) ê°€ë¡œÂ·ì„¸ë¡œ Â±5mm ì´ë‚´ â†’ ì •í™• ë§¤ì¹­ (ë³€í˜• ì—†ìŒ)
  const exact = sheetData.find(r =>
    Math.abs(parseFloat(r.width) - w) <= TOLERANCE &&
    Math.abs(parseFloat(r.height) - h) <= TOLERANCE
  );
  if (exact) return { ...exact, variant: false };

  // 2) ëŒ€ê°ì„  ê¸°ë°˜ ë§¤ì¹­
  // ì…ë ¥ê°’ì˜ ëŒ€ê°ì„  ê¸¸ì´ ê³„ì‚°
  const inputDiag = Math.sqrt(w * w + h * h);

  // ì‹œíŠ¸ì˜ ê° í–‰ ëŒ€ê°ì„  ê³„ì‚° (diagonal ì»¬ëŸ¼ ìš°ì„ , ì—†ìœ¼ë©´ widthÂ·heightë¡œ ê³„ì‚°)
  const withDiag = sheetData.map(r => {
    const diag = parseFloat(r.diagonal) || Math.sqrt(parseFloat(r.width) ** 2 + parseFloat(r.height) ** 2);
    return { ...r, _diag: diag };
  });

  // ì…ë ¥ ëŒ€ê°ì„ ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ì€ í•­ëª© ì¤‘ ê°€ì¥ ì‘ì€ ê²ƒ ì„ íƒ (ê·¼ì ‘í•œ í° ê°’)
  const larger = withDiag
    .filter(r => r._diag >= inputDiag)
    .sort((a, b) => a._diag - b._diag);

  if (larger.length > 0) return { ...larger[0], variant: true };

  // ëª¨ë‘ ì…ë ¥ê°’ë³´ë‹¤ ì‘ìœ¼ë©´ ê°€ì¥ í° í•­ëª©
  const fallback = withDiag.sort((a, b) => b._diag - a._diag);
  if (fallback.length > 0) return { ...fallback[0], variant: true };

  return null;
}

function showProduct(w, h) {
  const area = document.getElementById('product-area');
  if (!sheetLoaded || w === null || h === null) { area.innerHTML = ''; return; }
  const p = findProduct(w, h);
  if (p) {
    const price = parseInt(p.price, 10);
    const priceStr = isNaN(price) ? p.price : price.toLocaleString('ko-KR') + 'ì›';
    const displayName = p.variant ? `${p.name} ë³€í˜•` : p.name;
    const nameBadge = p.variant
      ? `<span style="background:#fff3cd;color:#856404;font-size:10px;font-weight:700;padding:2px 6px;border-radius:4px;margin-left:4px;">ë³€í˜•</span>`
      : '';
    area.innerHTML = `<div class="product-card">
      <div style="display:flex; align-items:center; gap:8px; flex-wrap:wrap;">
        <div class="product-name">ğŸ“¦ ${p.name}${nameBadge}</div>
        <div style="font-family:'Space Mono',monospace; font-size:11px; color:#9ca3af; font-weight:600;">${p.width} Ã— ${p.height} mm</div>
      </div>
      <div class="product-price">${priceStr}</div>
    </div>`;
  } else {
    area.innerHTML = `<div class="product-card not-found"><div class="product-name">âš  ì¼ì¹˜í•˜ëŠ” ì œí’ˆ ì—†ìŒ</div><div class="product-price">ì‹œíŠ¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”</div></div>`;
  }
}

function calculate() {
  const w = parseFloat(document.getElementById('width').value);
  const h = parseFloat(document.getElementById('height').value);
  const d = parseFloat(document.getElementById('depth').value);
  const resultEl = document.getElementById('result');

  if (isNaN(w) && isNaN(h) && isNaN(d)) {
    resultEl.innerHTML = '<div class="placeholder">ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•˜ë©´ ë„ë©´ì´ í‘œì‹œë©ë‹ˆë‹¤</div>';
    document.getElementById('product-area').innerHTML = '';
    return;
  }

  // ê°€ë¡œê°€ ì„¸ë¡œë³´ë‹¤ ì‘ìœ¼ë©´ ìë™ìœ¼ë¡œ êµí™˜
  let adjW = isNaN(w) ? null : w;
  let adjH = isNaN(h) ? null : h;
  if (adjW !== null && adjH !== null && adjW < adjH) {
    [adjW, adjH] = [adjH, adjW];
  }

  const rw = adjW === null ? null : adjW + 30;
  const rh = adjH === null ? null : adjH + 30;
  const rd = isNaN(d) ? null : d + 17;

  showProduct(adjW, adjH);
  resultEl.innerHTML = `<div id="diagram-wrap">${drawDiagram(rw, rh, rd)}</div>`;
}

function fmt(v) {
  if (v === null) return 'â€”';
  return Number.isInteger(v) ? v.toString() : v.toFixed(1);
}

function drawDiagram(rw, rh, rd) {
  const svgW = 400, svgH = 300;
  const rawW = rw||200, rawH = rh||150, rawD = rd||30;
  const maxFW = 190, maxFH = 160;
  const aspect = rawW / rawH;
  let fW, fH;
  if (aspect >= 1) { fW = Math.min(maxFW, maxFH*aspect); fH = fW/aspect; }
  else             { fH = Math.min(maxFH, maxFW/aspect); fW = fH*aspect; }
  fW = Math.max(fW,60); fH = Math.max(fH,60);

  const dOff = Math.max(16, Math.min(48, (rawD/Math.max(rawW,rawH))*130));
  const ox = dOff*0.85, oy = dOff*0.48;
  const startX = 55+ox, startY = 45+oy;
  const ftl=[startX,startY], ftr=[startX+fW,startY];
  const fbr=[startX+fW,startY+fH], fbl=[startX,startY+fH];
  const btl=[ftl[0]-ox,ftl[1]-oy], btr=[ftr[0]-ox,ftr[1]-oy], bbl=[fbl[0]-ox,fbl[1]-oy];
  const p = pts => pts.map(pt=>pt.join(',')).join(' ');

  const frameCol='#c9a96e', sideCol='#9a6e30', topCol='#e8c878';
  const strokeCol='#6e4010', innerCol='#23234a', dimCol='#4f46e5';
  const ft=13;

  let svg = `<svg width="${svgW}" height="${svgH}" viewBox="0 0 ${svgW} ${svgH}" xmlns="http://www.w3.org/2000/svg">
  <defs><filter id="sh"><feDropShadow dx="2" dy="5" stdDeviation="5" flood-color="#000" flood-opacity="0.4"/></filter></defs>`;
  svg += `<polygon points="${p([btl,btr,ftr,ftl])}" fill="${topCol}" stroke="${strokeCol}" stroke-width="1.2"/>`;
  svg += `<polygon points="${p([btl,ftl,fbl,bbl])}" fill="${sideCol}" stroke="${strokeCol}" stroke-width="1.2"/>`;
  svg += `<rect x="${ftl[0]}" y="${ftl[1]}" width="${fW}" height="${fH}" fill="${frameCol}" stroke="${strokeCol}" stroke-width="1.5" filter="url(#sh)"/>`;
  svg += `<rect x="${ftl[0]+ft}" y="${ftl[1]+ft}" width="${fW-ft*2}" height="${fH-ft*2}" fill="${innerCol}" stroke="${strokeCol}" stroke-width="0.8"/>`;
  [[ftl,1,1],[ftr,-1,1],[fbr,-1,-1],[fbl,1,-1]].forEach(([pt,sx,sy])=>{
    svg += `<line x1="${pt[0]}" y1="${pt[1]}" x2="${pt[0]+sx*ft}" y2="${pt[1]+sy*ft}" stroke="${strokeCol}" stroke-width="0.8" opacity="0.5"/>`;
  });
  svg += `<line x1="${btl[0]}" y1="${btl[1]}" x2="${btr[0]}" y2="${btr[1]}" stroke="#f5e8b0" stroke-width="1.5" opacity="0.8"/>`;

  const ext=8, gap=14;
  if (rw!==null) {
    const y=fbr[1]+gap+16;
    svg += dimLine(fbl[0],y,fbr[0],y,`${fmt(rw)} mm`,dimCol);
    svg += extLine(fbl[0],fbl[1]+ext,fbl[0],y+5,dimCol);
    svg += extLine(fbr[0],fbr[1]+ext,fbr[0],y+5,dimCol);
  }
  if (rh!==null) {
    const x=fbr[0]+gap+24;
    svg += dimLine(x,ftr[1],x,fbr[1],`${fmt(rh)} mm`,dimCol);
    svg += extLine(ftr[0]+ext,ftr[1],x+5,ftr[1],dimCol);
    svg += extLine(fbr[0]+ext,fbr[1],x+5,fbr[1],dimCol);
  }
  if (rd!==null) {
    const mx=(ftr[0]+btr[0])/2-4, my=(ftr[1]+btr[1])/2-10;
    svg += `<line x1="${ftr[0]}" y1="${ftr[1]}" x2="${btr[0]}" y2="${btr[1]}" stroke="${dimCol}" stroke-width="1" stroke-dasharray="3,3"/>`;
    svg += arrowhead(ftr[0],ftr[1],btr[0],btr[1],dimCol);
    svg += arrowhead(btr[0],btr[1],ftr[0],ftr[1],dimCol);
    const angle=Math.atan2(btr[1]-ftr[1],btr[0]-ftr[0])*180/Math.PI;
    svg += `<text x="${mx}" y="${my}" fill="${dimCol}" font-family="Space Mono,monospace" font-size="10" font-weight="700" text-anchor="middle" transform="rotate(${angle},${mx},${my+5})">${fmt(rd)} mm</text>`;
  }
  svg += `</svg>`;
  return svg;
}

function extLine(x1,y1,x2,y2,col){return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="${col}" stroke-width="0.8" opacity="0.5"/>`;}
function arrowhead(x1,y1,x2,y2,col){
  const dx=x2-x1,dy=y2-y1,len=Math.sqrt(dx*dx+dy*dy),ux=dx/len,uy=dy/len,px=-uy,py=ux,s=5;
  return `<polygon points="${x1},${y1} ${x1+ux*s+px*s/2},${y1+uy*s+py*s/2} ${x1+ux*s-px*s/2},${y1+uy*s-py*s/2}" fill="${col}"/>`;
}
function dimLine(x1,y1,x2,y2,label,col){
  const dx=x2-x1,dy=y2-y1,len=Math.sqrt(dx*dx+dy*dy),ux=dx/len,uy=dy/len,px=-uy,py=ux,s=5;
  const ah1=`<polygon points="${x1},${y1} ${x1+ux*s+px*s/2},${y1+uy*s+py*s/2} ${x1+ux*s-px*s/2},${y1+uy*s-py*s/2}" fill="${col}"/>`;
  const ah2=`<polygon points="${x2},${y2} ${x2-ux*s+px*s/2},${y2-uy*s+py*s/2} ${x2-ux*s-px*s/2},${y2-uy*s-py*s/2}" fill="${col}"/>`;
  const mx=(x1+x2)/2,my=(y1+y2)/2,tOff=12;
  const tx=mx+px*tOff,ty=my+py*tOff;
  const angle=Math.atan2(dy,dx)*180/Math.PI;
  const da=(angle>90||angle<-90)?angle+180:angle;
  return `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}" stroke="${col}" stroke-width="1"/>
    ${ah1}${ah2}
    <text x="${tx}" y="${ty}" fill="${col}" font-family="Space Mono,monospace" font-size="11" font-weight="700"
      text-anchor="middle" dominant-baseline="middle" transform="rotate(${da},${tx},${ty})">${label}</text>`;
}

async function submitOrder() {
  const name  = document.getElementById('order-name').value.trim();
  const phone = document.getElementById('order-phone').value.trim();
  const qty   = parseInt(document.getElementById('order-qty').value);
  const msgEl = document.getElementById('order-msg');

  const w = parseFloat(document.getElementById('width').value);
  const h = parseFloat(document.getElementById('height').value);
  const d = parseFloat(document.getElementById('depth').value);

  if (isNaN(w) || w <= 0) { msgEl.textContent='ê°€ë¡œ ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }
  if (isNaN(h) || h <= 0) { msgEl.textContent='ì„¸ë¡œ ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }
  if (isNaN(d) || d <= 0) { msgEl.textContent='ë‘ê»˜ ì¹˜ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }
  if (!name)               { msgEl.textContent='ì£¼ë¬¸ì ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }
  if (!phone)              { msgEl.textContent='ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }
  if (!/^[0-9\-]+$/.test(phone)) { msgEl.textContent='ì „í™”ë²ˆí˜¸ëŠ” ìˆ«ìì™€ "-"ë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.'; msgEl.className='err'; return; }
  if (!qty||qty<1)         { msgEl.textContent='ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'; msgEl.className='err'; return; }

  const area = document.getElementById('product-area');
  const nameEl = area.querySelector('.product-name');
  const productName = nameEl
    ? nameEl.textContent.replace('ğŸ“¦ ','').replace('ë³€í˜•','').trim() + (nameEl.querySelector('span') ? ' ë³€í˜•' : '')
    : 'ë¯¸ì§€ì •';

  msgEl.className = '';
  msgEl.textContent = 'ì£¼ë¬¸ ì „ì†¡ ì¤‘â€¦';

  try {
    // Apps Script CORS ìš°íšŒ: URLSearchParams + no-cors
    const params = new URLSearchParams({
      name, phone, qty,
      productName,
      width:  isNaN(w) ? '' : w,
      height: isNaN(h) ? '' : h,
      depth:  isNaN(d) ? '' : d
    });

    await fetch(SHEET_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: params.toString()
    });

    // no-corsëŠ” ì‘ë‹µì„ ì½ì„ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ì „ì†¡ ì„±ê³µìœ¼ë¡œ ì²˜ë¦¬
    msgEl.className = '';
    msgEl.textContent = `âœ“ ì£¼ë¬¸ ì™„ë£Œ! ${name}ë‹˜ (${phone}) Â· ${productName} Â· ${qty}ê°œ`;
    document.getElementById('order-name').value = '';
    document.getElementById('order-phone').value = '';
    document.getElementById('order-qty').value = '1';
  } catch(err) {
    msgEl.className = 'err';
    msgEl.textContent = 'âš  ì£¼ë¬¸ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    console.error(err);
  }
}

loadSheet();

function formatPhone(input) {
  // ìˆ«ìì™€ - ë§Œ í—ˆìš©
  let val = input.value.replace(/[^0-9\-]/g, '');
  input.value = val;
}
</script>
</body>
</html>
